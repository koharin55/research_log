<%= form_with model: @log, html: { class: "js-log-form" } do |f| %>
  <% if @log.errors.any? %>
    <div class="errors card">
      <p><%= pluralize(@log.errors.count, "件") %>のエラーがあります。</p>
      <ul>
        <% @log.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :title, "タイトル" %>
    <%= f.text_field :title, required: true %>
  </div>

  <div class="field">
    <%= f.label :category_id, "カテゴリ" %>
    <%= f.collection_select :category_id,
          current_user.categories.order(:name), :id, :name,
          { include_blank: "未設定" } %>
  </div>

  <div class="field">
    <%= label_tag :tag_names, "タグ（カンマ区切り）" %>
    <%= text_field_tag :tag_names,
          @log.tags&.map(&:name)&.join(", "),
          placeholder: "例）Rails, ActiveRecord, VLOOKUP" %>
    <p class="hint">既存タグ候補は一覧画面のタグフィルタでサジェスト。</p>
  </div>

  <div class="field">
    <%= f.label :body, "メモ" %>
    <%= f.text_area :body, rows: 6 %>
  </div>

  <div class="field">
    <%= f.label :code, "コード" %>
    <%= f.text_area :code, rows: 10 %>
  </div>

  <div class="field">
    <%= f.label :images, "画像（0〜5枚）" %>
    <%= f.file_field :images, multiple: true, accept: "image/*" %>
    <p class="hint paste-hint">
      ファイル選択のほか、フォーム上で Ctrl+V するとスクリーンショットを画像として追加できます。
    </p>
  </div>

  <div class="actions">
    <%= f.submit class: "btn-accent" %>
    <%= link_to "キャンセル", logs_path, class: "btn-subtle" %>
  </div>
<% end %>
